---
path: /ru/part-13/1-pygame
title: Pygame
hidden: false
---

<text-box variant='learningObjectives' name="Цели обучения">

После этого раздела:

- у вас будет установлена библиотека pygame
- вы будете знать, как создать окно pygame и как завершить программу
- вы сможете выводить в окне pygame изображение, сохранённое в файле

</text-box>

В последних двух частях материалов этого курса мы познакомимся с библиотекой pygame. Это библиотека Python для разработки игр. Она помогает создавать графику, обрабатывать события клавиатуры и мыши и реализовывать другие необходимые для игр возможности.

## Установка pygame {#installing-pygame}

### Linux {#linux}

Откройте командную строку, введите `pip3 install pygame` и нажмите `Enter`.

<img src="pygame_linux.png">

После этого библиотека pygame должна установиться на ваш компьютер.

### Windows {#windows}

Откройте Windows Terminal: откройте меню, введите `cmd` и нажмите `Enter`:

<img src="13_1_1.png">

Откроется окно командной строки. Введите `pip3 install pygame` и нажмите `Enter`.

После этого библиотека pygame должна установиться на ваш компьютер.

Для установки могут потребоваться права администратора. Если команда выше не сработала, попробуйте запустить терминал от имени администратора: откройте меню Windows, найдите приложение CMD, нажмите правой кнопкой и выберите «Запуск от имени администратора».

Чтобы установить и использовать pygame, Python должен быть добавлен в переменную PATH — как описано [здесь](https://www.mooc.fi/en/installation/vscode/#python3).

### Mac {#mac}

Откройте _Terminal_, например через значок лупы в правом верхнем углу:

<img src="13-1-2.png">

Откроется поиск. Введите `terminal` и нажмите `Enter`:

<img src="13-1-3.png">

Введите следующую команду и нажмите `Enter`:

`pip3 install pygame`

<img src="13-1-4.png">

После этого библиотека pygame должна установиться на ваш компьютер.

## Первая программа {#your-first-program}

Вот простая программа, чтобы проверить, что установка pygame работает корректно:

```python
import pygame

pygame.init()
window = pygame.display.set_mode((640, 480))

window.fill((0,0,0))
pygame.display.flip()

while True:
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            exit()
```

При запуске программы должно появиться окно:

<img src="pygame_first.gif">

Программа просто показывает окно и работает до тех пор, пока пользователь не закроет его.

Разберёмся, какие шаги для этого нужны. Первая строка подключает библиотеку pygame: `import pygame`. Затем команда `pygame.init` инициализирует модули pygame, а следующая строка создаёт окно с помощью функции `pygame.display.set_mode`.

```python
pygame.init()
window = pygame.display.set_mode((640, 480))
```

Функция `set_mode` принимает размеры окна. Кортеж `(640, 480)` означает, что окно имеет ширину 640 пикселей и высоту 480 пикселей. Переменную `window` можно использовать позже для доступа к окну — например, чтобы что‑то рисовать в нём.

Следующие две команды делают именно это:

```python
window.fill((0, 0, 0))
pygame.display.flip()
```

Метод `fill` заливает окно цветом, переданным аргументом. В данном случае это чёрный цвет, заданный RGB‑кортежем `(0, 0, 0)`. Функция `pygame.display.flip` обновляет содержимое окна.

После команд инициализации начинается _главный цикл_ программы:

```python
while True:
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            exit()
```

Главный цикл обрабатывает все события, которые операционная система передаёт программе. На каждой итерации `pygame.event.get` возвращает список событий, накопившихся с прошлой итерации.

В примере выше программа обрабатывает только событие типа `pygame.QUIT`. Оно возникает, например, когда пользователь нажимает кнопку закрытия окна. Если возникает `pygame.QUIT`, программа завершается вызовом `exit`.

Попробуйте посмотреть, что будет, если программа не обрабатывает `pygame.QUIT`. Тогда кнопка закрытия окна ничего не сделает, что, конечно, запутает пользователя. Так как программа запущена из командной строки, её всё ещё можно остановить сочетанием `Control+C`.

## Добавляем изображение {#add-an-image}

Добавим изображение в окно:

```python
import pygame

pygame.init()
window = pygame.display.set_mode((640, 480))

robot = pygame.image.load("robot.png")

window.fill((0, 0, 0))
window.blit(robot, (100, 50))
pygame.display.flip()

while True:
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            exit()
```

Программа использует изображение робота, которое хранится в файле `robot.png`:

<img src="robot.png">

Файл `robot.png` должен находиться в той же папке, что и исходный код программы, иначе программа не сможет его найти. В шаблонах упражнений этой части изображения уже лежат в папке упражнения.

Окно должно выглядеть так:

<img src="pygame_pic.gif">

Функция `pygame.image.load` загружает изображение из файла `robot.png` и сохраняет ссылку на него в переменной `robot`. Метод `blit` рисует изображение в точке `(100, 50)`, а `pygame.display.flip`, как и раньше, обновляет содержимое окна. Координаты `(100, 50)` означают, что в этой точке находится _верхний левый угол_ изображения.

В pygame начало координат `(0, 0)` находится в верхнем левом углу окна. Координата `x` увеличивается вправо, а `y` — вниз, так что правый нижний угол окна имеет координаты `(640, 480)`. Это отличается от привычной математической системы координат, но в программировании такой подход распространён — стоит к нему привыкнуть.

После загрузки изображение можно использовать много раз в одном и том же окне. Следующий код рисует робота в трёх разных местах:

```python
window.blit(robot, (0, 0))
window.blit(robot, (300, 0))
window.blit(robot, (100, 200))
```

В результате окно будет выглядеть так:

<img src="pygame_pic2.gif">

А здесь мы размещаем изображение так, чтобы оно оказалось в центре окна:

```python
width = robot.get_width()
height = robot.get_height()
window.blit(robot, (320-width/2, 240-height/2))
```

Теперь окно будет выглядеть так:

<img src="pygame_pic3.gif">

Метод `get_width` возвращает ширину изображения, а `get_height` — его высоту (оба значения в пикселях). Центр окна находится в точке, равной половине ширины и высоты, то есть `(320, 240)`. Зная размеры изображения, мы можем вычислить координаты его верхнего левого угла так, чтобы изображение оказалось ровно по центру.

<text-box variant='hint' name='Упражнения по Pygame'>

В упражнениях этой части нет автоматических тестов, потому что результат проверяется визуально. Баллы начисляются автоматически при отправке решения на сервер — независимо от того, как именно оно реализовано. Отправляйте решение только тогда, когда вы готовы и оно соответствует описанию упражнения. Хотя автоматических тестов нет, сотрудники курса всё равно видят ваши решения. Кроме того, отправка неполного решения через TMC Paste тоже автоматически начисляет баллы, поэтому не используйте TMC Paste, когда просите помощи по упражнениям этой части. Для этого можно воспользоваться, например, [Pastebin.com](https://pastebin.com/) или любым другим pastebin‑сервисом.

Если ваше решение явно не соответствует описанию упражнения, вы можете потерять начисленные за него баллы.

</text-box>

<programming-exercise name='Четыре робота' anchor="Four robots" tmcname='part13-01_four_robots'>

Напишите программу, которая рисует робота в каждом из четырёх углов окна. Итог должен выглядеть так:

<img src="pygame_four.gif">

</programming-exercise>

<programming-exercise name='Роботы в ряд' anchor="Robots in a row" tmcname='part13-02_robots_row'>

Напишите программу, которая рисует десять роботов в ряд. Итог должен выглядеть так:

<img src="pygame_row.gif">

</programming-exercise>

<programming-exercise name='Сто роботов' anchor="A hundred robots" tmcname='part13-03_hundred_robots'>

Напишите программу, которая рисует сто роботов: 10 рядов по 10 роботов в каждом. Итог должен выглядеть так:

<img src="pygame_hundred.gif">

</programming-exercise>

<programming-exercise name='Случайные роботы' anchor="Random robots" tmcname='part13-04_random_robots'>

Напишите программу, которая рисует _тысячу_ роботов в случайных местах. Итог должен выглядеть так:

<img src="pygame_thousand.gif">

</programming-exercise>
